<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="estilos.css">
  <title>Práctica Formativa 1 - Seminario de actualización DevOps</title>
</head>

<body>
  <header>
    <h1>Práctica Formativa 1 - Seminario de actualización DevOps</h1>
  </header>
  <main>
    <section class="card">
      <h2>Bienvenidos</h2>
      <p>
        Vamos a usar este proyecto para practicar branching, merging, resolución de conflictos,
        mensajes de commit claros y el flujo de trabajo de Pull Requests.
      </p>
      <!-- <p>
        Próximamente aquí se añadirá la nueva interfaz de perfil y la integración con backend.
      </p> -->

      <hr />

      <h3>Nuevo Perfil - Datos Personales</h3>
      <form id="perfil-form">
        <div>
          <label for="username">Nombre de usuario</label><br />
          <input type="text" id="username" name="username" placeholder="Nombre de usuario" required />
        </div>
        <div style="margin-top: 0.75rem;">
          <label for="password">Contraseña</label><br />
          <input type="password" id="password" name="password" placeholder="Contraseña segura" required />
        </div>
        <button type="submit" style="margin-top: 1rem;">Guardar</button>
      </form>

      <div id="resultado" style="margin-top: 1rem;"></div>
    </section>
  </main>
  <script>
    // Envío de datos personales al backend usando fetch (JSON)
    const form = document.getElementById('perfil-form');
    const resultado = document.getElementById('resultado');

    if (form) {
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        resultado.textContent = 'Enviando...';
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value;

        try {
          const resp = await fetch('/api/registrar.php', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username, password })
          });

          const data = await resp.json().catch(() => ({ status: 'error', message: 'Respuesta no válida' }));
          if (resp.ok && data.status === 'ok') {
            resultado.textContent = 'Registro OK';
            resultado.style.color = 'green';
          } else {
            resultado.textContent = `Error: ${data.message || 'Error al registrar'}`;
            resultado.style.color = 'red';
          }
        } catch (err) {
          resultado.textContent = 'Error de red o servidor no disponible';
          resultado.style.color = 'red';
        }
      });
    }
  </script>
</body>

</html>


</section>
</main>
</body>

</html>